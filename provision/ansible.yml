---
 - hosts: all
   tasks:
   - name: Ensure dependencies are installed.
     pkgng: name={{item}} state=present cached=true
     with_items:
     - git
     - lang/go

   - name: Build jetpack
     command: "{{ item }}"
     args:
       chdir: "/vagrant"
     with_items:
     - "make PREFIX=/usr/local"
     - "make install PREFIX=/usr/local"
   
   - name: Bootstrap zfs
     zfs: name=zroot/jetpack mountpoint=/var/jetpack state=present 
